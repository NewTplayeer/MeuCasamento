<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Presentes - Bruno & Maria</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { gold: '#a8905b', dark: '#2d2d2d' },
                    fontFamily: { serif: ['"Cormorant Garamond"', 'serif'], sans: ['"Montserrat"', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        .scale-in { animation: scaleIn 0.3s ease-out; }
        @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .tracking-widest-extra { letter-spacing: 0.2em; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>

<body class="text-dark bg-stone-50 min-h-screen flex flex-col font-sans selection:bg-gold selection:text-white">

    <header class="py-16 px-4 text-center bg-white border-b border-gray-100 shadow-sm sticky top-0 z-40">
        <div class="max-w-4xl mx-auto">
            <i data-lucide="gift" class="w-8 h-8 mx-auto text-gold mb-4 stroke-[1.5]"></i>
            <h1 class="text-4xl md:text-6xl font-serif text-dark mb-4 tracking-tight">Bruno Freitas & Maria Fernanda</h1>
            <div class="w-24 h-px bg-gold mx-auto mb-4"></div>
            <p class="text-gray-400 uppercase tracking-widest-extra text-[10px] md:text-xs">Lista de Presentes</p>
        </div>
    </header>

    <div id="status-banner" class="hidden"></div>

    <main id="client-view" class="flex-grow max-w-7xl mx-auto px-4 py-16 w-full animate-in fade-in slide-in-from-bottom-4 duration-700">
        <div class="text-center mb-16 max-w-3xl mx-auto">
            <p class="font-serif text-2xl text-gray-500 italic leading-relaxed">
                "A vossa presença é o nosso maior presente. Mas se desejar contribuir para o início da nossa vida a dois, preparamos algumas opções abaixo."
            </p>
        </div>

        <div id="gifts-grid" class="grid grid-cols-2 md:grid-cols-3 gap-6 md:gap-8">
            <div class="col-span-full text-center py-20 text-gray-400 font-serif italic border border-dashed border-gray-300 rounded-sm">
                A carregar lista...
            </div>
        </div>
        
        <div class="text-center mt-16">
            <a href="index.html" class="text-[10px] uppercase tracking-widest text-gray-400 hover:text-dark border-b border-transparent hover:border-dark pb-1 transition-all">
                &larr; Voltar ao Convite
            </a>
        </div>
    </main>

    <main id="admin-view" class="hidden flex-grow max-w-7xl mx-auto px-4 py-12 w-full">
        <div class="flex justify-between items-center mb-8 border-b border-gray-200 pb-4">
            <div>
                <h2 class="font-serif text-3xl text-dark">Gestão</h2>
                <div id="db-status-indicator" class="text-[10px] uppercase font-bold text-amber-500 mt-1">A Conectar...</div>
            </div>
            <button onclick="window.setView('client')" class="text-[10px] uppercase tracking-widest bg-white border border-gray-200 px-4 py-2 rounded-sm hover:bg-gray-50">Sair</button>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="bg-white p-8 rounded-sm shadow-xl border border-gray-100 h-fit sticky top-24">
                <h3 class="font-bold uppercase text-[10px] tracking-widest-extra text-gray-400 mb-6">Novo Presente</h3>
                <form id="gift-form" class="space-y-5">
                    <input type="hidden" id="edit-id">
                    <input id="form-nome" placeholder="Nome do Item" class="w-full border-b border-gray-200 py-2 text-sm outline-none focus:border-dark bg-transparent" required>
                    <div class="grid grid-cols-2 gap-4">
                        <input id="form-valor" type="number" step="0.01" placeholder="Valor" class="w-full border-b border-gray-200 py-2 text-sm outline-none focus:border-dark bg-transparent">
                        <input id="form-total-quotas" type="number" placeholder="Cotas" class="w-full border-b border-gray-200 py-2 text-sm outline-none focus:border-dark bg-transparent" required>
                    </div>
                    <input id="form-pix-key" placeholder="Chave PIX" class="w-full border-b border-gray-200 py-2 text-sm outline-none focus:border-dark bg-transparent">
                    
                    <button type="submit" id="btn-save" class="w-full py-4 bg-dark text-white text-[10px] uppercase tracking-widest hover:bg-black transition-all mt-4 rounded-sm shadow-md">Salvar</button>
                    <button type="button" id="btn-cancel-edit" onclick="window.resetGiftForm()" class="hidden w-full py-2 text-gray-400 text-[10px] uppercase tracking-widest hover:text-dark mt-2 border-b border-transparent hover:border-dark">Cancelar</button>
                </form>
            </div>

            <div class="lg:col-span-2 space-y-8">
                <div class="bg-white p-8 rounded-sm shadow-xl border border-gray-100">
                    <div class="flex justify-between mb-6 border-b border-gray-100 pb-4">
                        <h3 class="font-bold uppercase text-[10px] tracking-widest-extra text-gray-400">Contribuições</h3>
                        <button onclick="window.handleClearAllContribs()" class="text-red-400 text-[10px] font-bold uppercase tracking-widest hover:text-red-600">Limpar Tudo</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left"><tbody id="contributions-list"></tbody></table>
                    </div>
                </div>
                <div class="bg-white p-8 rounded-sm shadow-xl border border-gray-100">
                    <h3 class="font-bold uppercase text-[10px] tracking-widest-extra text-gray-400 mb-6">Vitrine</h3>
                    <div id="admin-gifts-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>
            </div>
        </div>
    </main>

    <footer class="py-12 text-center border-t border-gray-200 mt-auto bg-white">
        <button onclick="window.appController.openLoginModal()" class="text-gray-300 hover:text-dark text-[10px] uppercase tracking-widest flex items-center gap-2 mx-auto transition-colors">
            <i data-lucide="lock" class="w-3 h-3"></i> Área do Casal
        </button>
    </footer>

    <div id="modal-login" class="fixed inset-0 z-50 hidden items-center justify-center bg-dark/50 backdrop-blur-sm p-4">
        <div class="bg-white p-10 max-w-sm w-full shadow-2xl relative scale-in border-t-4 border-gold rounded-sm">
            <button onclick="window.closeModal('modal-login')" class="absolute top-4 right-4 text-gray-400 hover:text-dark"><i data-lucide="x" class="w-4 h-4"></i></button>
            <h3 class="font-serif text-3xl mb-2 text-center text-dark">Acesso Restrito</h3>
            <input type="password" id="login-pass-input" placeholder="SENHA" class="w-full border-b border-gray-200 py-3 text-center text-xl tracking-widest outline-none mb-8 focus:border-dark" onkeypress="if(event.key === 'Enter') window.handleAdminAuth()">
            <button onclick="window.handleAdminAuth()" class="w-full py-4 bg-dark text-white text-[10px] uppercase tracking-widest hover:bg-black rounded-sm">Entrar</button>
        </div>
    </div>

    <div id="modal-gift" class="fixed inset-0 z-50 hidden items-center justify-center bg-dark/50 backdrop-blur-sm p-4">
        <div class="bg-white p-10 max-w-md w-full shadow-2xl scale-in border-t-4 border-gold rounded-sm text-center">
            <h3 class="font-serif text-3xl mb-2 text-dark">Com Carinho</h3>
            <p id="modal-gift-name" class="text-gray-400 italic mb-8 font-serif text-lg"></p>
            
            <div class="text-left space-y-6">
                <div>
                    <label class="block text-[10px] uppercase tracking-widest text-gray-400 font-bold mb-2">Seu Nome</label>
                    <input id="guest-name-input" placeholder="Como devemos assinar?" class="w-full border-b border-gray-200 py-2 text-lg outline-none focus:border-dark bg-transparent">
                </div>
                <div class="flex justify-between items-center border-b border-gray-200 py-4">
                    <span class="text-[10px] uppercase font-bold text-gray-400">Quantidade</span>
                    <div class="flex items-center gap-4">
                        <button onclick="window.updateQty(-1)" class="w-8 h-8 flex items-center justify-center border border-gray-300 hover:bg-gray-100 rounded-sm">-</button>
                        <span id="modal-qty" class="text-xl font-bold w-8 text-center">1</span>
                        <button onclick="window.updateQty(1)" class="w-8 h-8 flex items-center justify-center border border-gray-300 hover:bg-gray-100 rounded-sm">+</button>
                    </div>
                </div>
                <div id="modal-total-box" class="text-center py-2"><p id="modal-total" class="text-3xl font-serif text-gold italic"></p></div>
                <button id="btn-confirm-gift" onclick="window.handleConfirmContribution()" class="w-full py-4 bg-dark text-white rounded-sm text-[10px] uppercase tracking-widest hover:bg-black shadow-lg">Confirmar</button>
                <button onclick="window.closeModal('modal-gift')" class="w-full text-gray-400 text-[10px] uppercase tracking-widest mt-2 hover:text-dark">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="modal-pix" class="fixed inset-0 z-50 hidden items-center justify-center bg-dark/50 backdrop-blur-sm p-4">
        <div class="bg-white p-10 max-w-md w-full shadow-2xl scale-in border-t-4 border-gold rounded-sm text-center">
            <h3 class="font-serif text-3xl mb-4 text-dark">Muito Obrigado!</h3>
            <p id="pix-instruction" class="text-sm text-gray-500 mb-6"></p>
            <div class="bg-gray-50 p-4 border border-gray-100 inline-block mb-6 rounded-sm"><img id="pix-qr" class="w-48 h-48 object-contain mix-blend-multiply"></div>
            <div class="flex items-center justify-between gap-4 bg-gray-50 p-4 border border-gray-100 rounded-sm text-left mb-6">
                <div class="overflow-hidden"><p class="text-[10px] uppercase font-bold text-gold">Chave PIX</p><p id="pix-payload" class="text-xs font-mono text-dark truncate"></p></div>
                <button onclick="window.copyPixToClipboard()" class="p-2 border bg-white hover:bg-gray-50"><i id="pix-copy-icon" data-lucide="copy" class="w-4 h-4 text-gray-500"></i></button>
            </div>
            <button onclick="window.handleFinishProcess()" class="w-full py-4 bg-dark text-white rounded-sm text-[10px] uppercase tracking-widest hover:bg-black">Concluir</button>
        </div>
    </div>

    <div id="modal-confirm" class="fixed inset-0 z-50 hidden items-center justify-center bg-dark/50 backdrop-blur-sm p-4">
        <div class="bg-white p-8 max-w-sm w-full shadow-2xl scale-in border-t-4 border-red-500 rounded-sm text-center">
            <i data-lucide="alert-triangle" class="w-10 h-10 text-red-500 mx-auto mb-4"></i>
            <h3 id="confirm-title" class="font-serif text-xl mb-2">Tem a certeza?</h3>
            <p id="confirm-msg" class="text-sm text-gray-500 mb-6"></p>
            <div class="flex gap-4">
                <button onclick="window.closeModal('modal-confirm')" class="flex-1 py-3 bg-gray-100 text-[10px] uppercase tracking-widest text-dark rounded-sm">Não</button>
                <button id="btn-confirm-action" class="flex-1 py-3 bg-red-500 text-white text-[10px] uppercase tracking-widest hover:bg-red-600 rounded-sm">Sim</button>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
    <script>window.addEventListener('load', () => lucide.createIcons());</script>
</body>
</html>